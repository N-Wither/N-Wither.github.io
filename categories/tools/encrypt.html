<!DOCTYPE html>
<html lang="zh-cn">

<head>
    <meta charset="utf-8">
    <link href='https://fonts.googleapis.com/css?family=Readex Pro' rel='stylesheet'>
    <link href='https://fonts.googleapis.com/css?family=Noto Serif SC' rel='stylesheet'>
    <link href='https://fonts.googleapis.com/css?family=Noto Sans SC' rel='stylesheet'>
    <link href='https://fonts.googleapis.com/css?family=ZCOOL KuaiLe' rel='stylesheet'>
    <link rel="stylesheet" type="text/css" href="https://N-Wither.github.io/assets/css/main-1.css">
    <link rel="shortcut icon" href="https://avatars.githubusercontent.com/u/63383462?v=4">
    <title>通讯加密器</title>
    <script src="https://n-wither.github.io/assets/js/utils.js"></script>
    <style>
        textarea {
            background-color: #00000033;
            width: 100%;
            min-height: 200px;
            border: 1px solid #00000000;
            color: white;
            font-family: 'Readex Pro';
            resize: none;
            font-size: 12px;
        }

        button {
            background-color: #00000033;
            min-width: 80px;
            border: none;
            margin-top: 8px;
            margin-bottom: 8px;
            padding: 5px;
            color: white;
        }

        button:active {
            background-color: #00000066;
        }

        #copytext {
            position: fixed;
            left: 99999px;
        }
    </style>
    <script>
        function toUnicode(text) {
            var index = 0, output = new Array(), charout = new Array();
            while (index < text.length) {
                var character = text.charAt(index), charCode = text.charCodeAt(index);
                if (charCode >= 0xD800 && charCode <= 0xDBFF) {
                    output.push(((charCode - 0xD800) * 0x400 + text.charCodeAt(++index) - 0xDC00 + 0x10000).toString(16).toUpperCase());
                    charout.push(character + text.charAt(index));
                } else {
                    output.push(charCode.toString(16).toUpperCase());
                    charout.push(character);
                }
                ++index
            }

            for (let i = 0; i < output.length; i++) {
                if (output[i].length < 4) {
                    output[i] = ('000' + output[i]).slice(-4);
                }
                else {
                    output[i] = output[i];
                }
            }

            return output;
        }

        function encrypt() {
            let text_input = document.getElementById('text_input').value;
            let unicode = toUnicode(text_input);
            let codeArray = [];
            let element;
            let temp;
            for (let i = 0; i < unicode.length; i++) {
                element = unicode[i];
                temp = '' + element[2] + element[3] + element[1] + element[0];
                codeArray.push(temp);
            }

            text_output = codeArray.toString().replace(/,/g, ' ');

            document.getElementById('text_output').innerHTML = text_output;
        }

        function decrypt() {
            let codeArray = document.getElementById('text_input').value.split(' ')
            let encrypted;
            let temp;
            let output = '';
            for (let i = 0; i < codeArray.length; i++) {
                encrypted = codeArray[i];
                temp = '' + encrypted[3] + encrypted[2] + encrypted[0] + encrypted[1];
                console.log(temp)
                output += String.fromCharCode(parseInt(temp, 16));
            }

            text_output = output;
            document.getElementById('text_output').innerHTML = text_output;
        }

        function swap() {
            document.getElementById('text_input').value = document.getElementById('text_output').innerHTML;
            document.getElementById('text_output').innerHTML = '加密/解密后的结果将显示在这里'
        }

        function copy() {
            var t = document.getElementById('text_output').value;
            if (t == '') return false;
            document.getElementById('copytext').value = t;
            var element = document.getElementById('copytext'), error = '你的浏览器不支持此操作，请手动复制！';
            element.select();
            try {
                if (document.execCommand('copy', false, null)) {
                    document.getElementById('copied').innerHTML = '已复制！';
                } else alert(error)
            } catch (err) {
                alert(error)
            }
            setTimeout(() => {document.getElementById('copied').innerHTML = ''}, 1000)
        }
    </script>
</head>

<body onload="startTime(), hello(), randomQuote()">
    <div class="navigate" id="navigate">
        <a href="https://n-wither.github.io/categories/writings/tools/index.html"
            style="line-height: unset; height: 50px;">📂<span
                style="font-size: larger;"><strong>Tools</strong></span></a>
        <a href="https://n-wither.github.io">🏠<span>Home</span></a>
        <a href="https://n-wither.github.io/categories/writings/index.html">📚<span>Writings</span></a>
    </div>
    <div class="toolbox" id="toolbox">
        <div id="clock">clock</div>
    </div>
    <div class="content">
        <div>
            <h1>通讯加密器</h1>
            <hr />
        </div>
        <div class="mainText">
            <p>
                我已经被敏感信息搞掉两个群了，事实证明阴阳怪气和小众缩写黑话并不能防止被爆破，所以我搞了这个。
            </p>
            <br />
            <textarea id="text_input" placeholder="要加密/解密的文本..." type="text"></textarea>
            <div>
                <button id="encrypt" type="button" onclick="encrypt()">加密！</button>
                <button id="decrypt" type="button" onclick="decrypt()">解密！</button>
                <button id="swap" type="button" onclick="swap()">将结果作为输入</button>
            </div>
            <textarea readonly id="text_output">加密/解密后的结果将显示在这里。</textarea>
            <button type="button" id="copy" onclick="copy()">复制到剪贴板</button>
            <textarea id="copytext" readonly></textarea>
            <span id="copied"></span>
        </div>
        <div id="footer" style="clear:both;text-align:center;">
            <hr />
            <span id="randomQuote">Random Quote</span>
            <br>
            Powered by <a href="https://pages.github.com/">Github Pages</a>.
        </div>
    </div>
</body>

</html>